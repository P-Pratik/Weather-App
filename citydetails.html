<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CityDetails</title>
</head>

<body>
    <h1>Details</h1>
    <p id="cityname">City Name</p>
    <table id="fields-table">
        <thead>
          <tr>
            <th>Date</th>
            <th>Max Temperature</th>
            <th>Min Temperature</th>
            <th>Humidity</th>
            <th>Conditions</th>
          </tr>
        </thead>
        <tbody id="fields-body">
          <!-- Table rows will be inserted here -->
        </tbody>
      </table>
</body>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    let name = urlParams.get("name");
    console.log(name);
    document.querySelector('#cityname').innerHTML = name;
    const data = {
        name
    }
    fetch('http://localhost:3000/request-city-data', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
        .then(response => response.json())
        .then(data => {
            console.log(data);
            // document.querySelector('#response').innerHTML = responseData.message;

            data.document.days.forEach((item) => {
                let row = document.createElement('tr');
                let date = document.createElement('td');
                let maxtemp = document.createElement('td');
                let mintemp = document.createElement('td');
                let humidity = document.createElement('td');
                let conditions = document.createElement('td');
                date.innerHTML = item.datetime;
                maxtemp.innerHTML = item.tempmax;
                mintemp.innerHTML = item.tempmin;
                humidity.innerHTML = item.humidity;
                conditions.innerHTML = item.conditions;
                row.appendChild(date);
                row.appendChild(maxtemp);
                row.appendChild(mintemp);
                row.appendChild(humidity);
                row.appendChild(conditions);
                document.querySelector('#fields-body').appendChild(row);
            })
        })
        .catch(err => {
            console.log(err);
        });

</script>

</html>